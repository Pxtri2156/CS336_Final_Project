<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Anime Finder</title>
    <link rel="icon" href="../electronics.png" type="image/x-icon">
</head>
<body id="bd">
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="/">TTS</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item active">
                <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">API</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Pricing</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#">Documentation</a>
            </li>
        </ul>
    </div>
</nav>
<div class="cont bor" style="overflow: scroll">
    <h1 class="title">ANIME QUERY</h1>

    <div class="container overflow-auto" style="margin-top: 50px;">
        <form id="f">
            <div class="form-row">
                <div class="col-md-4 mb-3">
                    <label for="method">Feature Extraction Method</label>
                    <select id="method" class="form-control">
                        <option value="COLOR" selected>COLOR</option>
                        <option value="VGG">VGG</option>
                        <option value="DELF" disabled>DELF</option>
                        <option value="HOG">HOG</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="lsh">Wanna some LSH?</label>
                    <select id="lsh" class="form-control">

                        <option value="1">YES</option>
                        <option value="0" selected>NO</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="similarity">Similarity Method</label>
                    <select id="similarity" class="form-control">
                        <option disabled selected value="">Select</option>
                        <option value="cosine" selected >Cosine</option>
                        <option value="euclidean">Euclidean</option>
                        <option value="nanhatan">Manhatan</option>
                        <option value="norm2">Norm2</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="col-md-4 mb-3 ">
                    <label>Select Your Image</label>
                </div>
            </div>

            <div class="form-group custom-file mb-3">
                <input type="file" class="custom-file-input" id="query" accept="image/*">
                <label class="custom-file-label" for="query" id="queryLabel">Loading container
                    image</label>
            </div>
            <div class="form-group">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="check" required>
                    <label class="form-check-label" for="check">
                        Agree to terms and conditions
                    </label>
                </div>
            </div>

            <div class="form-group">
                <div class="offset-md-5 col-md-2 mb-3 offset-5 col-2">
                    <button class="btn btn-primary" type="button" id="btn">Run</button>
                    <button class="btn btn-secondary" type="button" id="cancel">Cancel</button>
                </div>
            </div>

        </form>
    </div>

</div>

<div class="img-cont bor">
    <a class="image" href="#">
        <img src="https://tungtang.com.vn/images/td/images/10687.jpg" >

    </a>
    <a class="image" href="#">
        <img src="https://tungtang.com.vn/images/td/images/10687.jpg" >

    </a>
    <a class="image" href="#">
        <img src="https://tungtang.com.vn/images/td/images/10687.jpg" >

    </a>
    <a class="image" href="#">
        <img src="https://tungtang.com.vn/images/td/images/10687.jpg" >

    </a>

</div>

</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

<script>
    let query = document.getElementById('query')
    let similarity = document.getElementById('similarity')
    let lsh = document.getElementById('lsh')
    let method = document.getElementById('method')


    let btn = document.getElementById('btn')


    btn.addEventListener('click',()=>{
        let data = new FormData()
        data.append('query_image',query.files[0])
        data.append('method',method.value)
        data.append('lsh',lsh.value)
        data.append('similarity',similarity.value)
        console.log(data.values())

        fetch('/api/query',{
            method:'POST',
            body:data
        })
        .then(res=>res.json())
        .then(res=>{
            let val = generate_result(res.img[0],res.img[1],res.img[2],res.links[0],res.links[1],res.links[2])
            document.getElementById('bd').insertAdjacentHTML(val)
        })
    })
    function generate_result(q,im1,im2,im3,link1,link2,link3) {
        return `
        <div class="img-cont bor">
            <a href="#">
                <img src="${q}" id="" class="image">
            </a>
            <a href="${link1}">
                <img src="${im1}" id="" class="image">
            </a>
            <a href="${link2}">
                <img src="${im2}" id="" class="image">
            </a>
            <a href="${link3}">
                <img src="${im3}" id="" class="image">
            </a>
        </div>
        `
    }
    function getEncodedImage(name,isQ) {
        if(isQ==undefined){
            return fetch('/api')
        }else{

        }

    }
</script>
<style>
    .cont {
        display: flex;
        width: 100vw;
        height: 80vh;
        justify-content: center;
        align-items: center;
        overflow: scroll;
        flex-direction: column;
        /* border: solid; */
    }

    .img-cont {
        display: flex;
        width: 100vw;
        height: auto;
        justify-content: space-evenly;
        align-items: center;
        overflow: scroll;
        flex-direction: row;
    }

    .image {
        width: 23%;

    }
    .image > img{
        width: 100%;
    }
    .title {
        font-size: 100px;
        /*margin-bottom: 10%;*/
        text-align: center;
    }

    .bor {
        border: 1px solid #ff0000;
    }
</style>

</html>
